version: '3'
services:
  loom:
    build: ./dappchain
    ports:
     - "46658:46658"
  ganache:
    image: trufflesuite/ganache-cli
    command: "-p 8545 --gasLimit 50000000 -e 100000 -m \"gravity top burden flip student usage spell purchase hundred improve check genre\""
    ports:
    - "8545:8545"
  truffle-dappchain:
    build: ./truffle-dappchain
    depends_on:
      - loom
    expose:
      - "8081"
    environment:
      - NODE_ENV=development
      - IS_DOCKER=1
      - GATEWAY_DAPPCHAIN_ADDRESS=0xC5d1847a03dA59407F27f8FE7981D240bff2dfD3      
    volumes:
      - ./dappchain:/dappchain
  truffle-ethereum:
    build: ./truffle-ethereum
    depends_on:
      - ganache
      - loom
    expose:
      - "8082"
    environment:
      - NODE_ENV=development
    volumes:
      - ./dappchain:/dappchain
  transfer-gateway-scripts:
    build: ./transfer-gateway-scripts
    depends_on:
      - loom      
      - ganache
      - truffle-dappchain
      - truffle-ethereum    
    volumes:
      - ./dappchain:/dappchain
    environment:
      - IS_DOCKER=1